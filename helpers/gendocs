#!/bin/bash
source venv/bin/activate
set -e -x

for nb in notebooks/*.ipynb; do
    jupyter nbconvert --to markdown $nb
done
mv notebooks/examples.md docs/examples.md

verb() {
    echo
    echo '```'
}
endverb() {
    echo '```'
    echo
}

(
cat <<EOF
Documentation as generated by 'pydoc3' (default Python documentation
viewer). You can view this at the command line by typing 
'pydoc3 objio.io'.
EOF
for mod in objio objio.io; do
    echo "# module \`$mod\`"
    verb
    pydoc3 $mod
    endverb
done 
) > docs/pydoc.md

(
cat <<EOF
Usage information for command line programs.
EOF
for command in obj; do
    echo "# $command (command)"
    verb
    ./$command --help
    endverb
    ./$command --help | sed '1,/^Commands:/d' | awk '{print $1}' |
    while read subcommand; do
        echo "## $command $subcommand (subcommand)"
        verb
        ./$command $subcommand --help
        endverb
    done
done
) > docs/commands.md

#mkdocs build
